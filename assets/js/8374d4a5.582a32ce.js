"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[3319],{3639(e,n,a){a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"js-functions","title":"JS Arrow Functions","description":"Since v3.56.0","source":"@site/docs/16-js-functions.mdx","sourceDirName":".","slug":"/js-functions","permalink":"/docs/js-functions","draft":false,"unlisted":false,"editUrl":"https://github.com/gwen-interpreter/gwen-interpreter.github.io/edit/master/docs/16-js-functions.mdx","tags":[],"version":"current","sidebarPosition":16,"frontMatter":{"toc_min_heading_level":2,"toc_max_heading_level":3},"sidebar":"tutorialSidebar","previous":{"title":"String Interpolation","permalink":"/docs/string-interpolation"},"next":{"title":"Implicit Values","permalink":"/docs/implicit-values"}}');var t=a(4848),s=a(8453);a(8774),a(1470),a(9365),a(6025);const i={toc_min_heading_level:2,toc_max_heading_level:3},l="JS Arrow Functions",o={},c=[{value:"Zero argument expressions",id:"zero-argument-expressions",level:2},{value:"Single argument functions",id:"single-argument-functions",level:2},{value:"Implicit argument binding",id:"implicit-argument-binding",level:3},{value:"Explicit argument binding",id:"explicit-argument-binding",level:3},{value:"Dynamic argument binding",id:"dynamic-argument-binding",level:3},{value:"Multi argument functions",id:"multi-argument-functions",level:2},{value:"Implicit argument binding",id:"implicit-argument-binding-1",level:3},{value:"Explicit argument binding",id:"explicit-argument-binding-1",level:3},{value:"Dynamic argument binding",id:"dynamic-argument-binding-1",level:3},{value:"Inlined functions",id:"inlined-functions",level:2},{value:"Expressions",id:"expressions",level:3},{value:"Blocks",id:"blocks",level:3},{value:"Nested",id:"nested",level:3},{value:"REPL Support",id:"repl-support",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"js-arrow-functions",children:"JS Arrow Functions"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["Since ",(0,t.jsx)(n.a,{href:"https://github.com/gwen-interpreter/gwen-web/releases/tag/v3.56.0",children:"v3.56.0"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"You can execute JS functions in Gwen using the arrow syntax."}),"\n",(0,t.jsx)(n.h2,{id:"zero-argument-expressions",children:"Zero argument expressions"}),"\n",(0,t.jsx)(n.p,{children:"These accept no arguments and have either:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"a single expression in the body which returns a value"}),"\n",(0,t.jsx)(n.li,{children:"a block containing zero or more statements, followed by a return expression"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",children:'  Given today is defined by js "() => new Date().toISOString().substring(0, 10)"\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",children:'    And tomorrow is defined by js\n        """\n        () => { \n            const today = new Date()\n            const tomorrow = new Date()\n            tomorrow.setDate(today.getDate() + 1)\n            return tomorrow.toISOString().substring(0, 10)\n        }\n        """\n'})}),"\n",(0,t.jsx)(n.p,{children:"Prior to arrow functions being introduced, the equivalent of the above was:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",children:'    And tomorrow is defined by js\n        """\n        (function() { \n            const today = new Date()\n            const tomorrow = new Date()\n            tomorrow.setDate(today.getDate() + 1)\n            return tomorrow.toISOString().substring(0, 10)\n        })()\n        """\n'})}),"\n",(0,t.jsx)(n.h2,{id:"single-argument-functions",children:"Single argument functions"}),"\n",(0,t.jsx)(n.p,{children:"These accept a single argument and have either:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"a single expression that operates on the argument in the body and returns a value"}),"\n",(0,t.jsx)(n.li,{children:"a block containing zero or more statements that operate on the argument, followed by a return expression"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"implicit-argument-binding",children:"Implicit argument binding"}),"\n",(0,t.jsxs)(n.p,{children:["An argument is implicity bound to a same named reference in scope. In the following example, the argument ",(0,t.jsx)(n.code,{children:"name"})," on line 2 takes on the value of the ",(0,t.jsx)(n.code,{children:"name"})," reference one line 1 which sources its text value from a web element."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",metastring:"showLineNumbers",children:'  Given name can be located by css ".name"\n    And uppercased name is defined by js "(name) => name.toUpperCase()"\n'})}),"\n",(0,t.jsx)(n.p,{children:"Prior to arrow functions being introduced, the equivalent of the above was:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",children:"    And uppercased name is defined by js \"'${name}'.toUpperCase()\"\n"})}),"\n",(0,t.jsxs)(n.p,{children:["So if ",(0,t.jsx)(n.code,{children:"name"})," contained a single quote in it such as ",(0,t.jsx)(n.code,{children:"O'Reilly"})," for example, the above would have resolved to ",(0,t.jsx)(n.code,{children:"'O'Reilly'.toUpperCase()"}),", which would then result in a missing closed quote error at runtime. With arrow functions, this would never happen since the value is bound to the argument name and not a quoted literal. So arrow functions are much safer in this regard."]}),"\n",(0,t.jsx)(n.h3,{id:"explicit-argument-binding",children:"Explicit argument binding"}),"\n",(0,t.jsxs)(n.p,{children:["When references have spaces in their names, they cannot be implicitly bound to function arguments in the same manner as above (since JavaScript does not permit spaces in argument names). The solution is to explicitly assign the reference to the argument using the ",(0,t.jsx)(n.code,{children:"="})," operator. Here, the argument ",(0,t.jsx)(n.code,{children:"name"})," on line 4 takes on the value of the ",(0,t.jsx)(n.code,{children:"first name"})," reference on line 1 which sources its text value from a web element."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",metastring:"{1,4} showLineNumbers",children:'    Given first name can be located by css ".first_name"\n      And proper name is defined by js\n          """\n          (name = first name) => { \n              const head = name.charAt(0).toUpperCase()\n              const tail = name.slice(1).toLowerCase()\n              return head + tail\n          }\n          """\n'})}),"\n",(0,t.jsx)(n.h3,{id:"dynamic-argument-binding",children:"Dynamic argument binding"}),"\n",(0,t.jsx)(n.p,{children:"Suppose we wanted to reuse the above function to captitalise several names? The first step would be to redefine it without explicitly binding the name argument to any reference as follows:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",children:'    Given capitalise is defined by js\n          """\n          (name) => { \n              const head = name.charAt(0).toUpperCase()\n              const tail = name.slice(1).toLowerCase()\n              return head + tail\n          }\n          """\n'})}),"\n",(0,t.jsxs)(n.p,{children:["We can then apply it to different names by binding each one. In the following example, line 3 binds the ",(0,t.jsx)(n.code,{children:"name"})," argument to the value returned by ",(0,t.jsx)(n.code,{children:"first name"}),", applies our ",(0,t.jsx)(n.code,{children:"capitalise"})," function (above) to that and stores the resulting value in ",(0,t.jsx)(n.code,{children:"proper first name"}),". Line 4 does the same but with ",(0,t.jsx)(n.code,{children:"last name"})," instead."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",metastring:"{3-4} showLineNumbers",children:'  Given first name can be located by css ".first_name"\n    And last name can be located by css ".last_name"\n    And proper first name is defined by capitalise applied to "${first name}"\n    And proper last name is defined by capitalise applied to "${last name}"\n'})}),"\n",(0,t.jsx)(n.h2,{id:"multi-argument-functions",children:"Multi argument functions"}),"\n",(0,t.jsx)(n.p,{children:"These accept multiple arguments and have either:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"a single expression that operates on the arguments in the body and returns a value"}),"\n",(0,t.jsx)(n.li,{children:"a block containing zero or more statements that operate on the arguments, followed by a return expression"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"implicit-argument-binding-1",children:"Implicit argument binding"}),"\n",(0,t.jsxs)(n.p,{children:["Arguments are implicity bound to same named references. In this example, the arguments ",(0,t.jsx)(n.code,{children:"name"})," and ",(0,t.jsx)(n.code,{children:"surname"})," on line 3 take on the resolved values of the ",(0,t.jsx)(n.code,{children:"name"})," and ",(0,t.jsx)(n.code,{children:"surname"})," references on line 1 and 2 respecitvely, which each source their text values from two different web elements."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",metastring:"showLineNumbers",children:'  Given name can be located by css ".name"\n    And surname can be located by css ".surname"\n    And full name is defined by js "(name, surname) => name + \' \' + surname"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"explicit-argument-binding-1",children:"Explicit argument binding"}),"\n",(0,t.jsxs)(n.p,{children:["Here, the arguments ",(0,t.jsx)(n.code,{children:"name"})," and ",(0,t.jsx)(n.code,{children:"surname"})," on line 5 take on the resolved values of the ",(0,t.jsx)(n.code,{children:"first name"})," and ",(0,t.jsx)(n.code,{children:"last name"})," references on lines 1 and 2, which source their text values from two different web elements."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",metastring:"{1-2,5} showLineNumbers",children:'    Given first name can be located by css ".first_name"\n      And last name can be located by css ".last_name"\n      And full name is defined by js\n          """\n          (name = first name, surname = last name) => name + \' \' + surname\n          """\n'})}),"\n",(0,t.jsx)(n.h3,{id:"dynamic-argument-binding-1",children:"Dynamic argument binding"}),"\n",(0,t.jsx)(n.p,{children:"Suppose we wanted to reuse the above functions to captitalise both the first and last names and combine them into a proper full name?"}),"\n",(0,t.jsxs)(n.p,{children:["First, we capitalise the names by reusing the ",(0,t.jsx)(n.code,{children:"capitalise"})," function we defined earlier above:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",metastring:"{11-12}",children:'  Given capitalise is defined by js\n        """\n        (name) => { \n            const head = name.charAt(0).toUpperCase()\n            const tail = name.slice(1).toLowerCase()\n            return head + tail\n        }\n        """\n  And first name can be located by css ".first_name"\n  And last name can be located by css ".last_name"\n  And proper first name is defined by capitalise applied to "${first name}"\n  And proper last name is defined by capitalise applied to "${last name}"\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Then we reuse and apply the first ",(0,t.jsx)(n.code,{children:"full name"})," function we defined earlier to combine the two:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",metastring:"{2}",children:'  And full name is defined by js "(name, surname) => name + \' \' + surname"\n  And proper full name is defined by full name applied to "${proper first name},${proper last name}" delimited by ","\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Prior to arrow functions being introduced, the ",(0,t.jsx)(n.code,{children:"full name"})," function needed to be defined like this:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",children:"  And full name is defined by js \"(function(name, surname) { return name + ' ' + surname })(arguments[0], arguments[1])\"\n"})}),"\n",(0,t.jsx)(n.p,{children:"The arrow function equivalent is much cleaner and simpler:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",children:"  And full name is defined by js \"(name, surname) => name + ' ' + surname\"\n"})}),"\n",(0,t.jsx)(n.h2,{id:"inlined-functions",children:"Inlined functions"}),"\n",(0,t.jsx)(n.p,{children:"Functions can be used in placehoder references inline."}),"\n",(0,t.jsx)(n.h3,{id:"expressions",children:"Expressions"}),"\n",(0,t.jsxs)(n.p,{children:["Consider the following which uses the ",(0,t.jsx)(n.code,{children:"@Eager"})," annotation to immediately evaluate a function and store the result in ",(0,t.jsx)(n.code,{children:"uppercased name"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",metastring:"{2}",children:'  Given name can be located by css ".name"\n    And @Eager uppercased name is defined by js " name => name.toUpperCase() "\n'})}),"\n",(0,t.jsx)(n.p,{children:"Another way to do this could be to declare the function inline as follows:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",children:'    And uppercased name is "${ name => name.toUpperCase() }"\n'})}),"\n",(0,t.jsx)(n.p,{children:"Functions can be inlined in this manner wherever placehoders are used. When used in this way, they evaluate immediately and cannot be reused elsewhere."}),"\n",(0,t.jsx)(n.h3,{id:"blocks",children:"Blocks"}),"\n",(0,t.jsxs)(n.p,{children:["A more complex example follows. If ",(0,t.jsx)(n.code,{children:"name"})," resolves to 'GWEN' and ",(0,t.jsx)(n.code,{children:"surname"})," resolves to 'Butterfly', then the following function would set ",(0,t.jsx)(n.code,{children:"fancy full name"})," to 'BUFFERFLY, Gwen'."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",metastring:"{3-12}",children:'  Given name can be located by css ".name"\n    And surname can be located by css ".surname"\n    And fancy full name is \n        """\n        ${ \n            (name, surname) => {\n              const firstName = name.charAt(0).toUpperCase() + name.slice(1).toLowerCase()\n              const lastName = surname.toUpperCase()\n              return lastName + \', \' + firstName\n            }\n        }\n        """\n'})}),"\n",(0,t.jsx)(n.h3,{id:"nested",children:"Nested"}),"\n",(0,t.jsxs)(n.p,{children:["Inlined functions can also be nested. The following example reads a number from a web page, pads it with leading zeroes and then uses that to reference a value configured in another binding. In this example, if the ",(0,t.jsx)(n.code,{children:"number"})," field on a web page contains 1, then ",(0,t.jsx)(n.code,{children:"username"})," will be assigned to the username bound to ",(0,t.jsx)(n.code,{children:"user.001.username"})," (which could be a configured in a setting for example)."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",metastring:"{2}",children:'  Given number can be located by css ".number"\n    And username is "${user.${ number => (\'00\' + number).slice(-3) }.username}"\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Nesting should be used sparingly and would require the following annotation to pass a ",(0,t.jsx)(n.a,{href:"/docs/dry-run",children:"dry run"})," (since JS functions cannot be evaluated in dry runs):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gherkin",children:"  And username is    @DryRun(name=`number => ('00' + number).slice(-3)`,value='001')\n      \"\"\"\n      ${user.${ number => ('00' + number).slice(-3) }.username}\n      \"\"\"\n"})}),"\n",(0,t.jsx)(n.h2,{id:"repl-support",children:"REPL Support"}),"\n",(0,t.jsxs)(n.p,{children:["You can also exeucte arrow functions directly in the ",(0,t.jsx)(n.a,{href:"/docs/repl",children:"REPL console"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-script",children:"   __ ___      _____ _ __     _    \n  / _` \\ \\ /\\ / / _ \\ '_ \\   { \\,\" \n | (_| |\\ V  V /  __/ | | | {_`/   \n  \\__, | \\_/\\_/ \\___|_| |_|   `    \n  |___/                            \n\nWelcome to gwen-web v3.56.0\ngweninterpreter.org\n\n\nREPL Console\n\nEnter steps to evaluate or type help for more options..\n\ngwen> Given name is \"Gwen\"\n\n  [10ms] \u2714\n\ngwen> name => name.toUpperCase()\n\n  'GWEN'\n\ngwen> \n"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},9365(e,n,a){a.d(n,{A:()=>i});a(6540);var r=a(4164);const t="tabItem_Ymn6";var s=a(4848);function i({children:e,hidden:n,className:a}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(t,a),hidden:n,children:e})}},1470(e,n,a){a.d(n,{A:()=>k});var r=a(6540),t=a(4164),s=a(7559),i=a(3104),l=a(6347),o=a(205),c=a(7485),d=a(1682),u=a(679);function m(e){return r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h(e){const{values:n,children:a}=e;return(0,r.useMemo)(()=>{const e=n??function(e){return m(e).map(({props:{value:e,label:n,attributes:a,default:r}})=>({value:e,label:n,attributes:a,default:r}))}(a);return function(e){const n=(0,d.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,a])}function p({value:e,tabValues:n}){return n.some(n=>n.value===e)}function g({queryString:e=!1,groupId:n}){const a=(0,l.W6)(),t=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(t),(0,r.useCallback)(e=>{if(!t)return;const n=new URLSearchParams(a.location.search);n.set(t,e),a.replace({...a.location,search:n.toString()})},[t,a])]}function f(e){const{defaultValue:n,queryString:a=!1,groupId:t}=e,s=h(e),[i,l]=(0,r.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const a=n.find(e=>e.default)??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:s})),[c,d]=g({queryString:a,groupId:t}),[m,f]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[a,t]=(0,u.Dv)(n);return[a,(0,r.useCallback)(e=>{n&&t.set(e)},[n,t])]}({groupId:t}),b=(()=>{const e=c??m;return p({value:e,tabValues:s})?e:null})();(0,o.A)(()=>{b&&l(b)},[b]);return{selectedValue:i,selectValue:(0,r.useCallback)(e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),f(e)},[d,f,s]),tabValues:s}}var b=a(2303);const x="tabList__CuJ",j="tabItem_LNqP";var v=a(4848);function w({className:e,block:n,selectedValue:a,selectValue:r,tabValues:s}){const l=[],{blockElementScrollPositionUntilNextRender:o}=(0,i.a_)(),c=e=>{const n=e.currentTarget,t=l.indexOf(n),i=s[t].value;i!==a&&(o(n),r(i))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const a=l.indexOf(e.currentTarget)+1;n=l[a]??l[0];break}case"ArrowLeft":{const a=l.indexOf(e.currentTarget)-1;n=l[a]??l[l.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":n},e),children:s.map(({value:e,label:n,attributes:r})=>(0,v.jsx)("li",{role:"tab",tabIndex:a===e?0:-1,"aria-selected":a===e,ref:e=>{l.push(e)},onKeyDown:d,onClick:c,...r,className:(0,t.A)("tabs__item",j,r?.className,{"tabs__item--active":a===e}),children:n??e},e))})}function y({lazy:e,children:n,selectedValue:a}){const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=s.find(e=>e.props.value===a);return e?(0,r.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:s.map((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==a}))})}function _(e){const n=f(e);return(0,v.jsxs)("div",{className:(0,t.A)(s.G.tabs.container,"tabs-container",x),children:[(0,v.jsx)(w,{...n,...e}),(0,v.jsx)(y,{...n,...e})]})}function k(e){const n=(0,b.A)();return(0,v.jsx)(_,{...e,children:m(e.children)},String(n))}},8453(e,n,a){a.d(n,{R:()=>i,x:()=>l});var r=a(6540);const t={},s=r.createContext(t);function i(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);